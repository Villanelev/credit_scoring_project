# Credit Scoring: Прогнозирование дефолта клиента
Репозиторий содержит проект по разработке модели кредитного скоринга на основе данных Home Credit.

# Итоговые результаты (ROC-AUC)
1) MVP: 0,7622
2) 4 таблицы + небольшой Feature engineering: 0,7879


# Этапы разработки 
# 1) MVP
   На первом этапе работа велась только по начальной таблице application_train.csv
   ## Разведочный анализ и предобработка:
   При изучении таблицы первое, что бросается в глаза это огромное кол-во признаков (100+), что делает перебор и оценку их важности ручным способом весьма затруднительным.
   Прибавляя к этому предположение о том, что банк вряд ли станет собирать совсем бесполезную информацию о клиентах, я решил не удалять столбцы, за исключением тех в которых содержится 99%+ одинаковых значений.
   Обработка аномалий: При просмотре некоторых статистик числовых столбцов были обнаружены аномалии/заглушки, такие как 19 детей, 1000 лет стажа и тд.
   Чистка выбросов осуществлялась с помощью 99,5% клиппинга.
   Далее я удалил дубликаты статистик о площадях строений и оставил только медиану, как наиболее подходящую.
   ## Выбор модели
   После всех этапов предобработки настал момент выбора модели и обучения, поскольку данные содержат большое кол-во трудно заполняемых пропусков - логично было выбрать устойчивую к ним модель. Такой моделью стал Бустинг, а точнее категориальный бустинг catboost.
   После разделения данных и обучения, ансамбль показал результат 0,76

# 2) Дальнейшие улучшения
   Теперь когда структура проекта готова и минимальная система сработала, я приступил к более серьезной работе.
   ## Обработка Аpplication:
   После небольшого анализа я пересмотрел подход и не стал динамически удалять столбцы с одинаковыми значениями тк это вызывает расхождение с тестовыми данными.
   Были исправлены временные колонки (с отрицательными значениями) и заполнены некоторые пропуски.
   Feature engineering: теперь пришло время добавлять новые фичи. По опыту первой модели я увидел, что основными признаками были данные о клиентах из других источников - отсюда мне пришла идея добавить различные их комбинации (среднее трех, произведение и тд)
Далее для краткости расскажу основные моменты.
   ## Обработка Bureau:
   Логически дополнил данные: если кредит закрыт или продан, значит долг по нему 0. Добавил отношение долга к сумме кредита и флаг для пустых значений в AMT_CREDIT_SUM_DEBT, чтобы модель понимала, где инфа скрыта. Всё это агрегировал через максы, средние и суммы.
   ## Обработка Installments:
   С таблицей Installments было интереснее всего, потому что это показатель дисциплины. Я посчитал просрочку в днях и на сколько раньше клиент обычно платил. Добавил процент оплаты и разницу в суммах. Тут важным было посчитать дисперсию этих метрик: если человек платит то вовремя, то с задержкой - это риск, и модель должна это видеть.
  ## Обработка Previous Application
В этой таблице я смотрел, как клиент вел себя раньше. Сделал фичу APP_CREDIT_PERC — сколько он просил денег и сколько ему в итоге одобрили. Агрегировал статусы заявок: сколько было отказов и одобрений, под какой процент человек обычно брал деньги. Естественно, почистил все системные заглушки в датах, которые могли исказить картину.

## Текущий результат
  После мерджа всех таблиц я приступил к финальному обучению. Для начала я уменьшил глубину дерева (что свойственно бустингу), снизил learning rate, увеличил кол-во итераций, добавив раннюю остановку. После экспериментов с гиперпараметрами зафиксировал итоговую сборку и оптимальное количество итераций, затем обучил модель на всем датасете. Финальные цифры на кегле составили: Private Score = 0.78687, Public Score = 0.78729. В дальнейшем я планирую учитывать остальные таблицы, экспериментировать с новыми фичами и реализовать стекинг.


    
   

